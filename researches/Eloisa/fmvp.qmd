---
title: "Forecasting Monthly Vegetable Prices in the Province of Nueva Vizcaya"
author:
  - Jaime Niel P. Alap   
  - Glomie G. Gonzales
  - Eloisa J. Jimenez
  - Carlo D. Pastores, Jr.
format:
  docx:
    reference-doc: student-research-template.docx
editor: visual
bibliography: references.bib
csl: apa.csl
execute: 
  cache: true
---

# Chapter I

## INTRODUCTION

### Background of the Study

The fluctuation of vegetable prices is a global concern in both developed and emerging economies. The demand for vegetables as a primary source of essential nutrients and dietary variety has increased concomitantly with urbanization and global population growth. Consequently, the dynamics of vegetable pricing have grown more intricate and significant, having an effect not just on consumer choices but also on food security, economic stability, and agricultural practices. Understanding the factors driving these price fluctuations is paramount for policymakers, farmers, consumers, and the broader food industry [@chen18].

Vegetables are a major life necessity for urban and rural residents, and the vegetable market massively supports rural economic development. Fluctuations in vegetable prices affect farmers' income, quality of life, and decision-making regarding vegetable planting. Therefore, issues regarding maintaining price stability have long been focused on government policies. In recent years, the price of vegetables has exhibited dramatic and frequent volatility, which caused a series of negative effects on stakeholders in the supply-chain, e.g., farmers, logistics, wholesale, retail, and consumers. In view of the above adverse effects on stakeholders, it is of crucial importance to filter out key factors that relate to price fluctuations, targeting effective monitoring of real-time abnormal fluctuations [@chen18].

Price fluctuation is a complex issue with far-reaching consequences, especially for vulnerable populations. While higher prices may appear beneficial for farmers, the inherent volatility poses significant risks, potentially leading to substantial losses for agricultural stakeholders. Often attributed to imbalances in market fundamentals, where demand surpasses supply, this phenomenon has a profound impact on small-scale farmers [@mchopa14].

Prices for vegetables fluctuate frequently, harming the financial interests of farmers, business owners, and consumers. Vegetable market prices are influenced by market supply and demand mechanisms, as well as a variety of internal and external influences. Weather fluctuations are one of these aspects, and they can have varied degrees of impact on the entire process of planting, harvesting, transporting, and selling vegetables. The supply chain for vegetables in China is more vulnerable to weather extremes due to the spatial concentration of vegetable production and the dispersed consumer base, resulting in an imbalance between supply and demand and abnormally large-scale fluctuations in vegetable prices that have an impact on people's livelihoods [@yang22].

According to @fao, agricultural products account for a large proportion of the market as a necessity for daily consumption, and their prices play a critical part in consumer spending and agricultural household income. The supply and demand in a given year determine the prices of agricultural products. While an under supply of agricultural items raises prices and burdens consumers, an oversupply of agricultural products causes vegetable prices to increase and causes financial losses to farming households.

Moreover, vegetable prices have an impact on farmers' income, standard of living, and vegetable producing choices. This is due to the cyclical and seasonal swings that affect vegetable prices; the price trend would alter based on the season, demand, and other factors. Therefore, concerns about price stability have typically focused on government initiatives. Vegetable prices have varied sharply and frequently recently, having a variety of negative effects on supply-chain participants like farmers, transportation, wholesale, retail, and customers [@chen18].

Policy uncertainty may rise as a result of fluctuating commodity prices [@qiao23]. Distributors may find it challenging to plan purchases, inventory control, and pricing strategies due to this unpredictability. Distributors who are unable to anticipate price fluctuations may face financial losses if they buy vegetables at a high price and then the price drops before they can sell them. According to Yiyang et al., smallholder farmers are more vulnerable to risk when prices fluctuate. This is due to the fact that smallholder farmers frequently have little resources and are unable to absorb the potential financial losses caused by changes in prices. These price-induced risks could have an impact on distributors who depend on smallholder farmers for their supplies because they can result in supply disruptions and higher sourcing expenses.

In the Philippines, vegetables price height has been a major problem for past years. Consumers were complaining of higher food prices, reflected not only in vegetables but in poultry and pork meat as well, and selected fish variants. Some prices have gone up by as much as 66 percent from last month alone. The Department of Agriculture officials have blamed the higher prices on numerous factors such as the ongoing pandemic, the devastating typhoons that destroyed crops, and the unwillingness of poultry and hog raisers to farm a new following the glut and the spread of the African swine fever, respectively.

As stated by @vibas19, Agricultural commodities significantly impact a country's export earnings and economic performance. Price fluctuations affect farmers, consumers, and public agencies. The Department of Agriculture in the Philippines recognizes that local market-driven commodity pricing, notably for fruits and vegetables, have prompted government action.

Nueva Vizcaya Agricultural Terminal (NVAT) General Manager Gilbert Cumila said, vegetable prices in the Philippines continue to rise as demand exceeds supply. Wholesale prices of vegetables increases due to the demand of people. This significantly affect the way consumers purchase vegetables to sustain their necessities.

The purpose of the study is to fully comprehend the factors affecting changes in vegetable prices in Nueva Vizcaya. The study intends to offer significant insights and suggestions for farmers, consumers, and distributors by concentrating on forecasting the monthly vegetable prices. These stakeholders should be more prepared to react to monthly changes in vegetable prices when making decisions as a result of this research.

### Statement of the Problem

In response to the challenge of volatile vegetable prices faced by local farmers, distributors, and consumers, the researchers would provide forecasts of monthly vegetable prices in Nueva Vizcaya. This effort aims to assist them in making informed decisions regarding agricultural production, distribution, and vegetable purchases.

To do this, the researchers would use five (5) years available time series of vegetable prices from the Nueva Vizcaya Agricultural Terminal (NVAT) to come up with models that would forecast monthly vegetable prices in Nueva Vizcaya. First, the researchers would describe the monthly vegetable prices in Nueva Vizcaya. Next, the researchers would fit models to the data. The researchers would then determine which model has the best forecast performance for each vegetable and then use them to forecast monthly vegetable prices in Nueva Vizcaya.

### Objectives of the Study

The researchers would forecast monthly vegetable prices in Nueva Vizcaya by accomplishing the following:

1.  Describe the monthly prices for each vegetable in Nueva Vizcaya from 2017-2023.

2.  Determine the optimal AutoRegressive Integrated Moving Average (ARIMA) and Exponential Smoothing (ETS) models for forecasting monthly prices for each vegetable in Nueva Vizcaya from 2017-2023.

3.  Determine the performance of the optimal model — whether ARIMA or ETS — for forecasting monthly prices for each vegetable data available within five (5) to six (6) months in a year in Nueva Vizcaya from 2017-2023.

4.  Use the optimal AutoRegressive Integrated Moving Average (ARIMA) or Exponential Smoothing (ETS) model to generate forecasts for monthly prices for each vegetable in Nueva Vizcaya.

### Significance of the Study

This study is focused on forecasting monthly vegetable prices in Nueva Vizcaya. The results of the study would be beneficial to the following:

**Department of Agriculture.** This research would be beneficial to the Department of Agriculture by incorporating its findings into policy formulation and resource allocation. Accurate price forecasts can inform agricultural development programs, subsidies, and interventions, ultimately supporting the growth and sustainability of the agricultural sector in Nueva Vizcaya.

**Local Farmers.** This research would be beneficial to the local farmers. It would provide them with valuable insights into future vegetable price trends. Accurate price forecasts would enable farmers to plan their planting and harvesting schedules efficiently, reduce wastage, and optimize their crop yields, ultimately leading to improved income stability and sustainable agricultural practices.

**Vendors.** This research would be beneficial to vendors in Nueva Vizcaya's vegetable markets. With reliable vegetable price forecasts, they can make informed purchasing decisions, maintain competitive prices, and increase profit margins. This, in turn, fosters a more stable and profitable business environment for vendors.

**Consumers.** This research would be beneficial to consumers as it helps maintain price stability and affordability. When vendors can make better decisions based on accurate forecasts, consumers are less likely to experience price shocks or sudden increases in vegetable prices, ensuring accessibility to essential food items.

**Future Entrepreneurs.** This research would be beneficial for future entrepreneurs looking to venture into the vegetable market in Nueva Vizcaya. The study's results can be utilized to make informed business decisions, aiding in the development of market entry strategies, inventory management strategies, and pricing strategies. This information is valuable for mitigating the risks associated with launching a new business.

**Business Owners.** This research would be beneficial to business owners in Nueva Vizcaya, whether they are in the agricultural sector or the retail and distribution sector. They can leverage predictive insights to optimize their supply chain operations. Improved supply chain efficiency can lead to cost savings and increased profitability.

**Future Researchers.** This research would serve as a valuable foundation for future researchers interested in agricultural economics, market dynamics, and forecasting methodologies. It would provide a benchmark dataset and insights that can be expanded upon and refined in subsequent research efforts, contributing to the continuous advancement of agricultural forecasting and market analysis.

### Scope and Delimitation of the Study

The study would focus on forecasting the monthly prices of vegetables in NVAT, Bambang, Nueva Vizcaya. The researchers would use 5 years available time series of vegetable prices from NVAT. From this data, monthly time series of prices for each vegetable would be described. ARIMA and ETS models would then be fitted to the data using automatic algorithms to determine optimal models for each vegetable. Time series cross-validation and a comparison of computed point forecast measures would help identify the optimal model that would be used in forecasting monthly prices for each vegetable. A portmanteau test of residuals would also be used to describe the performance of each optimal model chosen to forecast monthly vegetable prices for each vegetable.

The researchers would not make adjustments and transformations to the data. Model specifications would not be set either, as this process would be performed automatically using default settings. All computations and visualizations would be performed in the R programming language [@r]. Moreover, external variables impacting vegetable prices would not be investigated nor would be incorporated in the modeling process.

### Conceptual Framework

The research paradigm as shown in @fig-rp would guide the researchers in conducting the study. It consists of input, process, and output. The input would be the available time series of vegetable prices from NVAT. The output would be ARIMA and/or ETS models and their corresponding monthly forecasts. Under process, automatic algorithms would determine the best ARIMA and ETS models. From this, the better model would be determined using time series cross-validation; comparing their point forecast accuracy measures.

![Research Paradigm](pictures/rp.png){#fig-rp fig-align="center" width="600"}

During the process phase, automated algorithms would be employed for time series analysis to identify the optimal ARIMA and ETS models for each vegetable. Subsequently, the optimal ARIMA or ETS model for forecasting the prices of each vegetable would be determined using time series cross-validation, enabling a comparison of their point forecast accuracy measures.Also, a portmanteau test of residuals would be performed to describe the performance of the optimal model for each vegetable.

### Definition of Terms

**AutoRegressive Integrated Moving Average (ARIMA).** Utilize ARIMA to model and predict monthly vegetable prices by considering autoregressive and moving average components while addressing seasonality or trends through differencing, ensuring a more accurate representation of the variations over time.

**Exponential Smoothing (ETS).** Apply ETS as an alternative forecasting method to capture systematic trends or seasonal patterns in monthly vegetable prices, providing a robust approach beyond traditional ARIMA models for more comprehensive predictions.

**Forecasting.** Apply ETS as an alternative forecasting method to capture systematic trends or seasonal patterns in monthly vegetable prices, providing a robust approach beyond traditional ARIMA models for more comprehensive predictions.

**The Nueva Vizcaya Agricultural Terminal (NVAT).** Place to gather data of monthly vegetable prices.

**Root Mean Squared Error (RMSE).** Evaluate the accuracy of your forecasting models by calculating RMSE, which measures the average deviation between predicted and actual monthly vegetable prices. Lower RMSE values indicate better predictive performance, ensuring the reliability of your forecasting approach.

**Seasonal AutoRegressive Integrated Moving Average (SARIMA).** Enhance forecasting accuracy by incorporating SARIMA, an extension of ARIMA, to account for seasonal components in monthly vegetable prices. This is particularly beneficial when dealing with recurring seasonal patterns in the market.

**Time Series.** Analyze historical time series data of monthly vegetable prices to identify trends, patterns, and behavior over time. This helps in building models that can capture and predict future price movements accurately.

**Vegetable Price.** Study and forecast monthly vegetable prices are a key economic and agricultural indicator. Understand the supply and demand dynamics, and use forecasting models to predict how these prices might evolve in the future, aiding in decision-making for farmers, traders, and policymakers.

# Chapter II

## REVIEW OF RELATED LITERATURE

### Vegetable Prices

Vegetables have the greatest supply and price volatility of any agricultural item. Vegetables are difficult to keep in a consistent supply and price because they are grown outside and their yields vary greatly depending on the weather. As a result, vegetables have a substantial economic impact. Despite the government's best efforts, recurring weather shifts have generated instability in vegetable supply and price swings in recent years [@illankoon2020].

Prices for vegetables fluctuate frequently, harming the financial interests of farmers, business owners, and consumers. Vegetable market prices are influenced by market supply and demand mechanisms, as well as a variety of internal and external influences. Weather fluctuations are one of these aspects, and they can have varied degrees of impact on the entire process of planting, harvesting, transporting, and selling vegetables. The supply chain for vegetables in China is more vulnerable to weather extremes due to the spatial concentration of vegetable production and the dispersed consumer base, resulting in an imbalance between supply and demand and abnormally large-scale fluctuations in vegetable prices that have an impact on people's livelihoods [@yang22].

Moreover, vegetable prices have an impact on farmers' income, standard of living, and vegetable producing choices. This is due to the cyclical and seasonal swings that affect vegetable prices; the price trend will alter based on the season, demand, and other factors. Therefore, concerns about price stability have typically focused on government initiatives. Vegetable prices have varied sharply and frequently recently, having a variety of negative effects on supply-chain participants like farmers, transportation, wholesale, retail, and customers [@chen18].

The quality of life of residents will be directly impacted by frequent increases in vegetable market prices, which will also bury hidden dangers for the fall in vegetable prices in the subsequent round of prices. In contrast, the continued decline in vegetable market prices results in prices that are too low and negatively impact the vital interests and production enthusiasm of vegetable farmers, leaving the supply of vegetables poorly protected and causing the subsequent round of skyrocketing prices. Regional vegetable price fluctuations have a significant negative impact on farmers and consumers, which has an impact on the macroeconomic stability and significantly lowers the degree of regional social welfare [@gan20].

Vegetables are highly perishable products [@desalegn21]. This implies that a variety of factors, including supply and demand, weather, and storage availability, might have a significant impact on their pricing. Distributors may become uneasy as a result of these developments, which will make it challenging for them to project earnings and run their businesses efficiently. According to the study, the vegetable value chain commonly involves middlemen. When veggies are plentiful, these intermediaries usually take advantage of price volatility by buying them at a discount from growers and reselling them to clients at a premium when they are in short supply. Having to outbid middlemen for supplies may result in lower profit margins for distributors. As mentioned in the introduction of the study of Desalegn, smallholder farmers in rural areas usually lack access to functioning market information. They consequently struggle to anticipate price changes and effectively haggle for their produce. Distributors who depend on these farmers for their goods are indirectly impacted by this ignorance. It was also emphasized in the study of Desalegn that the perishable nature of vegetables is another issue. Distributors could therefore suffer since, when the market gets saturated, they won't be able to keep excess inventory on hand and would have to sell produce at a loss.

In the Philippines, sustainable soil nutrient-enhancing strategies involve the wise use and management of inorganic and organic nutrient sources in ecologically sound production systems [@janssen93]. The primary goal of integrated nutrient management (INM) is to combine old and new methods of nutrient management into ecologically sound and economically viable farming systems that utilize available organic and inorganic sources of nutrients in a judicious and efficient way. Integrated nutrient management optimizes all aspects of nutrient cycling. It attempts to achieve tight nutrient cycling with synchrony between nutrient demand by the crop and nutrient release in the soil, while minimizing losses through leaching, runoff, volatilization and immobilization. Providing higher economic returns per unit area and developing new export markets for high value crops in the Philippines has been identified as a priority by the Philippine Government and the Australian Centre for International Agricultural Research (ACIAR) as means of increasing economic growth and improving the standard of living of people living in rural areas. Regions VIII (Leyte), X (Northern Mindanao/Cagayan de Oro) and XI (Southern Mindanao/ Davao) have significant potential for expanding vegetable production. Moreover, they are seen as strategically important to the Australian Government, whereby efforts to improve the livelihoods of the populations in these areas could contribute to improving geo-political stability in the region [@tulin19].

Benguet, a mountainous province in the northern Philippines, trucks down at least 1,500 metric tons of semi-temperate vegetables every day to depots called bagsakan in Manila, the nation's capital. When demand spikes around holidays like Christmas and Easter, the volume of deliveries can triple. Eighty percent of the nation's need for semi-temperate vegetables like potatoes, cabbage, radish, chayote, carrot, lettuce, and broccoli is met by crops that are shipped from Manila throughout the archipelago. Situated atop the Cordillera mountain range, the high altitude of Benguet province is conducive to the production of these kinds of crops, which are also known as highland vegetables. With a minimum 1.1 million metric tons produced annually. However, as farmers use chemical-heavy fertilizers to boost yields, fifty years of toiling the land to feed millions across the country is causing the forest cover to slowly disappear and the soil to deteriorate. In addition to causing fluctuating vegetable prices and oversupply --- which frequently results in spoilage and losses for farmers --- the region's growing number of farmers and farmland, all of which are planting upland vegetables.

Pricing Theory and Law of Supply and Demand is used to interpret the gathered statistical data from previous studies in this systematic review of economics literature in the Philippines. It provides explanation on the responsiveness of seaweed farmers in the Philippines to the price changes in relation to the supply and demand that is changing from time to time. The strong demand of seaweed drives the market prices, and this may drive seaweed farmers to increase the seaweed production but when the price are low seaweed farmers have the tendency to leave their farms resulting in a low production of seaweed and in effect a decrease in seaweed supply. This problem may be enlightened using the law of supply and demand wherein when the demand is high --- the price is high, and the supply is low. On the other hand, if the demand is low --- the price is low, and the supply is high. As a result, the seaweed farmers are not responsive to price changes in the short-run and in the long-run [@guerrero22].

### Forecasting Vegetable Prices

Accurate agricultural price forecasting is critical to achieving sustainable and healthy agricultural development, and it is a hot research area in the agricultural industry. It explores traditional forecasting procedures, intelligent forecasting methods, and combination model forecasting methods, as well as the obstacles found in the current research landscape of agricultural commodity price prediction [@sun23].

Farming is first and foremost defined by family work, which is limited by the availability of land, water, and capital resources. Choosing which agricultural items to produce must be made by farmers, however there are oftentimes not enough possibilities to enable the best farming decisions. Farmers must choose which vegetables will bring in the highest prices at harvest. The aforementioned issue was fixed by estimating pricing based on weather conditions using machine learning technologies. The hopeful results of the Prediction model are what have made Machine Learning so well-liked. This paper explores the use of multiple regression models to forecast vegetable prices, and its applicability has also been taken into account. In order to plan for their forthcoming crop and prevent hyperinflation, farmers benefit from being able to estimate vegetable prices [@kakulapati22].

Forecasting vegetable prices is critical in the agricultural industry for making sound judgments. This forecasting task is quite difficult. Because neural networks are self-adaptive, have a high learning capacity, and are adaptable, they are used to tackle a wide range of difficult tasks. This model forecasts the price of vegetables for the next day based on the previous price of time series data. This research compares and contrasts three machine learning algorithms: radial basis function, back propagation neural network, and genetically based neural network. The models are assessed, and the accuracy percentages show that the genetically based neural network outperforms propagation neural networks and radial basis functions in terms of vegetable price prediction accuracy [@subhasree16].

The vegetable industry is crucial, particularly in terms of supplying an abundance of fresh agricultural products. For the agriculture sector to make wise decisions, vegetable price forecasting is essential. The challenges that Malaysian farmers face is not just related to aging, but also to their ability to compete in a country where consumers prioritize fresh produce and fruits from hypermarkets and wholesale markets over supermarkets. This review article aids in identifying the present issues facing Malaysia's agriculture industry and examines the connection between agriculture and e-commerce. The growth of e-agriculture has been noted by researchers recently, and the authors discovered that an agricultural e-commerce platform equipped with a price forecasting model could be useful in resolving a current national issue. This study examines the global agricultural e-commerce platforms currently in use and makes an attempt to compare it with the domestic market. Following the completion of the reviews, the authors propose building a time analysis model in a hybrid approach for vegetable price forecasting in an agricultural e-commerce platform. This model can be utilized by the government to inform policy decisions [@nath2023].

In the Philippines, box-Jenkins technique and the Autoregressive Moving Average (ARMA) model were used to forecast onion production. Using historical data from the Philippine Statistics Authority, the ARMA (4,2) model was applied to construct an optimal forecasting solution. The model passed diagnostic tests with a mean absolute percentage error (MAPE) of 10.406%. The predicted yields for each quarter were highlighted, as were projections for onion output in 2023 and 2024. An examination of historical data indicated that weather trends, consumer demand, agricultural techniques, and imports and exports all contribute to periodic variations in onion supply. The study's findings highlight the significance of employing exact forecasting models when deciding how to distribute resources, establish pricing, and place products on the market [@capiral23].

Commodity prices have an impact on both producers and consumers; therefore, estimating their future value is important for making decisions down the road. The purpose of this study is to assist policymakers in developing guidelines that will benefit producers and consumers of agricultural products such as sitao, whole chicken, eggplant, tomato, pork ham, and pork liempo. The chosen commodities' data behavior for the years 2013--2022 was examined by the researchers, and they all showed an upward trend with some fluctuations. Numerous factors, including seasonality of production, volume surplus, pest and disease, typhoon destruction, and importation, are found to be linked to these fluctuations. The researcher used the ARIMA technique to forecast the price of this agricultural produce after analyzing the price behavior [@zhang20].

Crop climate calendars enhance traditional crop calendars by providing phenological states, cultivation techniques, and weather and climatic requirements that all crops must meet during a cropping season, as well as planting and harvest timings. The case for capturing this data in Benguet is compelling: the mountainous province benefits from the growth of high-value crops like as carrots, cabbage, and potatoes despite weather phenomena such as hail, frost, and various microclimates. The researchers conducted focus groups with municipal agriculturalists and farmer leaders in Atok, Benguet, to better understand their experiences and build their crop climate calendar. The calendars developed during this experiment could provide as a solid foundation for investigating the area's climate-sensitive agricultural methods [@domingo20].

### Synthesis

Vegetable prices are influenced by various factors, both internationally and within specific countries like the Philippines. Internationally, studies have shown that vegetables have a high supply and price volatility due to their dependence on weather conditions. Weather fluctuations can lead to inconsistent vegetable supply and large-scale price fluctuations, impacting farmers, business owners, and consumers [@illankoon2020; @yang22]. This instability in prices affects farmers' income, standard of living, and their choices in vegetable production [@chen18].

In the Philippines, the pricing of vegetables is also influenced by factors such as market supply and demand, weather conditions, and storage availability. Distributors and middlemen play a role in price volatility, taking advantage of fluctuations to buy vegetables at a discount and resell them at a higher price when supply is low [@desalegn21]. Smallholder farmers in rural areas often lack access to market information, making it difficult for them to anticipate price changes and negotiate effectively, indirectly impacting distributors who rely on their produce. Additionally, the perishable nature of vegetables poses a challenge for distributors who may suffer losses when market saturation occurs and excess inventory cannot be stored.

Accurate forecasting of vegetable prices is crucial for sustainable agricultural development. Machine learning technologies and regression models have been used to forecast vegetable prices based on factors such as weather conditions, previous price data, and market trends [@kakulapati22; @subhasree16]. In the Philippines, forecasting models have been applied to predict the production and prices of specific vegetables like onions, using historical data and considering factors such as weather trends, consumer demand, and agricultural techniques [@capiral23].

In conclusion, vegetable prices are influenced by various factors internationally and within specific countries like the Philippines. Factors such as weather fluctuations, market supply and demand, and the role of distributors and middlemen contribute to price volatility. Accurate forecasting of vegetable prices using machine learning and regression models can help farmers and policymakers make informed decisions. Understanding and addressing these factors are crucial for achieving sustainable agricultural development and improving the livelihoods of farmers and consumers.

# Chapter III

## RESEARCH METHODOLOGY

### Research Design

The research would purely be quantitative in nature. Specifically, the researchers would employ comparative time series forecasting [@hyndman21]. In this study, AutoRegressive Integrated Moving Average (ARIMA) and Exponential Smoothing (ETS) models would be estimated using the monthly vegetable prices from NVAT. The researchers would then compare the estimated models and choose the one with higher accuracy to forecast monthly vegetable prices in Nueva Vizcaya.

### Locale of the Study

The study would be conducted in Bambang, Nueva Vizcaya. Specifically, the data for this study would be collected from NVAT, which is located in Bambang. Bambang is the next town south of Bayombong --- the capital town of the province of Nueva Vizcaya. Please see @fig-bambang below.

![Map of Bambang, Nueva Vizcaya (https://en.wikipedia.org/wiki/Bambang,\_Nueva_Vizcaya#/media/File:Ph_locator_nueva_vizcaya_bambang.png)](pictures/bambang.png){#fig-bambang fig-align="center"}

### Source and Subject of the Study

The primary source of data for the research is the NVAT. Five (5) years available time series of vegetable prices from the NVAT would be used to come up with forecasts of monthly vegetable prices in Nueva Vizcaya.

### Data Gathering Procedure

The researchers would inquire about the background and data policy of NVAT by visiting its office. Additionally, letters requesting permission to gather data for the research would be written to the NVSU President, NVAT General Manager, and the Municipal Mayor of Bambang (refer to Appendix A, B, and C, respectively). Subsequently, the researchers would collect five (5) years available time series of vegetable prices. Throughout the data collection process, strict adherence to ethical considerations, including data confidentiality and approval from appropriate authorities, would be maintained.

### Data Analysis and Treatment of Data

In forecasting monthly vegetable prices in Nueva Vizcaya, the researchers would follow the process illustrated in @fig-workflow. It is an adapted representation of the workflow introduced by @hyndman21.

```{r}
#| label: diagram-workflow
#| echo: false
#| fig-width: 6

workflow <- DiagrammeR::grViz("digraph {

graph [layout = dot, rankdir = LR]

# define the global styles of the nodes. We can override these in box if we wish
node [shape = rectangle, style = filled, fillcolor = Linen]

B [label = 'Tidy']
C [label = 'Visualize']
D [label = 'Estimate']
E [label = 'Evaluate']
F [label = 'Forecast']

# edge definitions with the node IDs
B -> C -> D -> E -> F;
}")

vtree::grVizToPNG(workflow, filename = "pictures/workflow.png", width = 600)
```

![Data Treatment and Analysis Workflow](pictures/workflow.png){#fig-workflow fig-align="center" width="600"}

The tidy part involves preparing the raw data in the correct format. This includes loading the raw data into R and identifying and resolving missing values in order to create a tidy time series data for monthly vegetable prices. The researchers would utilize the `tsibble` and `tidyverse` packages for this task [@wickham19; @wang20].

Subsequently, the researchers would visualize the monthly vegetable prices in Nueva Vizcaya. The trend and seasonal components of the data would also be visualized using the seasonal and trend decomposition using LOESS (STL) method developed by @cleveland90. These visualizations are integral in describing the data.

Next, automatic algorithms introduced by @hyndman21 would be used to estimate or fit the optimal ARIMA and ETS models to the data. The researchers would implement these algorithms in R using the `fable` package[@fable].

Moreover, time series cross-validation would be used to evaluate forecast accuracy of the ARIMA and ETS models [@hyndman21]. Point forecast accuracy measures such as the mean absolute error (MAE), root mean squared error (RMSE), mean absolute percentage error (MAPE), and mean absolute squared error (MASE) would be computed and compared to determine the better model for each vegetable. The model with lower point forecast accuracy measures would be selected.

Furthermore, a portmanteau test in the form of the Ljung-Box test would be computed. This would allow the researchers to describe the performance of the selected model for each vegetable. Computed p-values greater than 0.05 confirms that the residuals are similar to white noise. Otherwise, the residuals still have some remaining autocorrelation that is not accounted for in the model.

Finally, the selected models would be used to forecast monthly vegetable prices in Nueva Vizcaya.

# CHAPTER IV

## RESULTS AND DISCUSSION

### Monthly Prices of Vegetables in NVAT

After encoding the available vegetable prices from the NVAT Facebook page, only 12 vegetables were chosen for the study. These vegetables are; broccoli, cabbage, carrots, cauliflower, celery, chayote (bunga) cucumber, gabi, pepper (sultan and Taiwan), potato, and wombok. The graph of the monthly time series of these vegetables are shown in figure 4.

```{r}
#| label: load-packages
#| include: false

library(tidyverse)
library(clock)
library(fpp3)
library(modelsummary)
library(flextable)
```

```{r}
#| label: load-data
#| include: false

nvat <- read.csv("data/nvat.csv")
```

```{r}
#| label: daily-to-monthly
#| include: false

nvat <- nvat |>
  mutate(date = dmy(date))

nvat_monthly <- nvat |>
  mutate(date = date_group(date, "month")) |>
  group_by(date) |>
  summarise(
    across(
      everything(), ~ mean(.[. != 0], na.rm = TRUE)
    )
  )
```

```{r}
#| label: wide-to-long
#| include: false

nvat_monthly_long <- gather(
  nvat_monthly,
  vegetable,
  price,
  broccoli:wombok,
  factor_key=TRUE
)
```

```{r}
#| label: tibble-to-tsibble
#| include: false

nvat_monthly_long <- nvat_monthly_long |>
  mutate(date = yearmonth(date)) |>
  as_tsibble(key = vegetable, index = date)
```

```{r}
#| label: veg_labels
#| include: false

veg_labels <- c('broccoli', 'cabbage', 'carrots', 'cauliflower', 'celery', 'chayote (bunga)', 'cucumber', 'gabi (galyang)', 'pepper (sultan)', 'pepper (taiwan)', 'potato', 'wombok')
```

```{r}
#| label: fig-plot_all
#| fig-cap: "Time Series of Monthly Vegetable Prices"
#| echo: false

autoplot(nvat_monthly_long, price) +
  theme_minimal() +
  labs(y = "Price", x = "Date") +
  guides(color = guide_legend(title = "Vegetable")) +
  scale_color_discrete(labels = veg_labels)
```

The vegetable with the most variability is pepper (Taiwan) with a standard deviation of 106.29. Its minimum price is 11.50 and its maximum price is 424.38, the highest price recorded among the vegetables. It also has the highest average price of 112.32. On the other hand, the vegetable that has the least variability is chayote (bunga) with a standard deviation of 7.81. Its minimum price is 4.17 and its maximum price is 45.25. It has the lowest average price of 12.99. The vegetable that has the lowest price is wombok with a minimum price of 4.14. The summary of monthly vegetable prices is shown in table 1.

```{r}
#| label: tbl-all
#| tbl-cap-location: top
#| tbl-cap: "Summary of Monthly Vegetable Prices"
#| echo: false

nvat_monthly_long |>
  as.data.frame() |>
  group_by(vegetable) |>
  summarise(
    Min = round(min(price), 2),
    Max = round(max(price), 2),
    Mean = round(mean(price), 2),
    SD = round(sd(price), 2)
  ) |>
  mutate(vegetable = veg_labels) |>
  rename(Vegetable = vegetable) |>
  flextable() |>
  bold(part = "header") |>
  line_spacing(space = .5, part = "body") |>
  set_table_properties(layout = "autofit", width = 1) |>
  font(part = "all", fontname = "Times New Roman") |>
  fontsize(size = 12, part = "all")
```

```{r}
#| label: tbl-stl
#| tbl-cap-location: top
#| tbl-cap: "STL Features of Monthly Vegetable Prices"
#| echo: false

nvat_monthly_long |>
  index_by(date) |>
  features(price, feat_stl) |>
  select(
    vegetable:seasonal_trough_year
  ) |>
  mutate_at(
    vars(seasonal_peak_year, seasonal_trough_year), ~
      recode(
        ., 
        '1' = 'October',
        '2' = "November",
        '3 '= "December",
        '4' = "January",
        '5' = "February",
        '6' = "March",
        '7' = "April",
        '8' = "May",
        '9' = 'June',
        '10' = 'July',
        '11' = 'August',
        '0' = 'September'
      )
  ) |>
  mutate(vegetable = veg_labels) |>
  rename(
    Vegetable = vegetable,
    'Trend Strength' = trend_strength,
    'Seasonal Strength' = seasonal_strength_year,
    'Seasonal Peak' = seasonal_peak_year,
    'Seasonal Trough' = seasonal_trough_year
  ) |>
  mutate_if(is.numeric, round, 2) |>
  flextable() |>
  bold(part = "header") |>
  line_spacing(space = .5, part = "body") |>
  set_table_properties(layout = "autofit", width = 1) |>
  font(part = "all", fontname = "Times New Roman") |>
  align(align = "center", part = "header") |>
  align(j = -1, align = "center", part = "body") |>
  fontsize(size = 12, part = "all")
```

Table 2 shows the STL features of monthly vegetable prices. The vegetable that has the strongest trend is gabi (galyang) with 0.91, showing that 91% of the time series is accounted by trend not considering seasonality. It is on upward trend. Meanwhile, the vegetable that has the weakest trend is wombok with 0.14, showing that 14% of the time series is accounted by trend not considering seasonality. The vegetable that has the strongest seasonality is cauliflower with 0.72, showing that 72% of the time series is accounted by seasonality not considering trend. Its peak is in August and its trough is March. The vegetable that has the weakest seasonality is cabbage with 0.18, showing that 18% of the time series is accounted by seasonality not considering trend.

```{r}
#| include: false

nvat_monthly_long |>
  filter(vegetable == "gabi_galyang") |>
  gg_subseries(price)
```

```{r}
#| label: fig-stl
#| fig-cap: "Seasonal Strength vs Trend Strength of the Monthly Vegetable Prices"
#| include: false

nvat_monthly_long |>
  features(price, feat_stl) |>
  ggplot(aes(x = trend_strength, y = seasonal_strength_year,
             col = vegetable)) +
  geom_point(size = 3) +
  labs(
    x = "Trend Strength",
    y = "Seasonal Strength"
  ) +
  guides(color = guide_legend(title = "Vegetable")) +
  theme_minimal() +
  scale_color_discrete(labels = veg_labels)
```

```{r}
#| include: false

nvat_monthly_long |>
  filter(vegetable == "cauliflower" | vegetable == "gabi_galyang") |>
  gg_season(price)
```

```{r}
#| include: false

nvat_monthly_long |>
  filter(vegetable == "pepper_taiwan") |>
  model(STL(price)) |>
  components() |>
  autoplot() +
    theme(
      strip.text = element_text(size = 8)
    )
```

### ARIMA and ETS Models for Monthly Vegetable Prices

```{r}
#| include: false

fit <- nvat_monthly_long |>
  stretch_tsibble(.init = 15, .step = 4) |>
  filter(.id != max(.id)) |>
  model(
    ARIMA = ARIMA(price),
    ETS = ETS(price)
  )
```

```{r}
#| echo: false

fit |>
  forecast(h = 4) |>
  accuracy(nvat_monthly_long) |>
  select(.model, RMSE, MAE, MAPE, MASE) |>
  mutate(Vegetable = rep(veg_labels, 2), .before = .model) |>
  arrange(Vegetable) |>
  mutate_if(is.numeric, round, 2) |>
  rename(Model = .model)
```

The table shows the model performance for forecasting montly vegetable prices. Brocolli for auto AutoRegressive Integrated Moving Average (ARIMA) is better in Mean Absolute Error (MAE), Mean Absolute Percetage Error (MAPE), and  Mean Absolute Scaled Error (MASE) but has a very low negligence in Root Mean Square Error (RMSE) in ARIMA. Additionally, the rest of the vegetables are best fitted in auto ARIMA for MAE, MAPE, and MASE model.

# References
